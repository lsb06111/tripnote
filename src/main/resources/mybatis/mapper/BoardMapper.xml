<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="edu.example.tripnote.dao.BoardDAO">
<select id="listAll" resultType="BoardDto">
   SELECT
	    b.id,
	    b.title,
	    board_content,
	    b.created_at,
	    b.modified_at,
	    u.nickname,
	    a.area_name,
	    b.thumbnail,
	    l.likes
	FROM
    	board b
        JOIN users  u ON b.user_id = u.id
        JOIN course c ON b.course_id = c.id
        JOIN area   a ON c.area_id = a.id
        LEFT JOIN (
            SELECT
                board_id,
                COUNT(*) AS likes
            FROM
                likes
            GROUP BY
                board_id
        )   l ON b.id = l.board_id
</select>

</mapper>